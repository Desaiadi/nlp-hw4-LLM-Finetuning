⚡ ~/hw4-code/part2-code python train_t5.py \
    --finetune \
    --learning_rate 5e-4 \
    --weight_decay 0.01 \
    --batch_size 32 \
    --max_n_epochs 15 \
    --patience_epochs 5 \
    --scheduler_type linear \
    --num_warmup_epochs 1 \
    --experiment_name Ad_config_final
Loading pretrained T5-small...
Model on cuda, 60.51M params
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:42<00:00,  3.16it/s]
Epoch 0: Train loss 2.5945
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:28<00:00,  4.94s/it]
466it [00:01, 404.65it/s]
Epoch 0: Dev loss 0.3825, F1 0.2072, RecEM 0.1760, SQLEM 0.0000, Err 66.31%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.17it/s]
Epoch 1: Train loss 0.3371
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:32<00:00,  3.07s/it]
466it [00:09, 50.12it/s] 
Epoch 1: Dev loss 0.1442, F1 0.3700, RecEM 0.2790, SQLEM 0.0043, Err 26.82%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.21it/s]
Epoch 2: Train loss 0.1758
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:25<00:00,  2.87s/it]
462it [02:00,  3.85it/s] 
Epoch 2: Dev loss 0.0970, F1 0.4323, RecEM 0.3476, SQLEM 0.0107, Err 31.33%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.20it/s]
Epoch 3: Train loss 0.1275
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:51<00:00,  3.73s/it]
465it [02:00,  3.87it/s] 
Epoch 3: Dev loss 0.0778, F1 0.5166, RecEM 0.4356, SQLEM 0.0193, Err 33.05%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.19it/s]
Epoch 4: Train loss 0.1044
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:37<00:00,  3.26s/it]
446it [02:00,  3.72it/s]
Epoch 4: Dev loss 0.0645, F1 0.5405, RecEM 0.4571, SQLEM 0.0150, Err 24.89%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.22it/s]
Epoch 5: Train loss 0.0853
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:46<00:00,  3.55s/it]
458it [02:00,  3.82it/s]
Epoch 5: Dev loss 0.0545, F1 0.6013, RecEM 0.5150, SQLEM 0.0172, Err 19.74%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.20it/s]
Epoch 6: Train loss 0.0743
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:44<00:00,  3.47s/it]
459it [02:00,  3.82it/s]
Epoch 6: Dev loss 0.0494, F1 0.6579, RecEM 0.5794, SQLEM 0.0172, Err 18.24%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:41<00:00,  3.20it/s]
Epoch 7: Train loss 0.0654
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:47<00:00,  3.59s/it]
462it [02:00,  3.85it/s]
Epoch 7: Dev loss 0.0446, F1 0.6475, RecEM 0.5837, SQLEM 0.0172, Err 18.03%
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:47<00:00,  2.78it/s]
Epoch 8: Train loss 0.0597
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:09<00:00,  4.31s/it]
465it [02:00,  3.87it/s]
Epoch 8: Dev loss 0.0421, F1 0.6924, RecEM 0.6073, SQLEM 0.0172, Err 13.30%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:45<00:00,  2.94it/s]
Epoch 9: Train loss 0.0542
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [01:59<00:00,  3.99s/it]
464it [02:00,  3.87it/s]
Epoch 9: Dev loss 0.0387, F1 0.6958, RecEM 0.6159, SQLEM 0.0172, Err 14.38%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:47<00:00,  2.78it/s]
Epoch 10: Train loss 0.0513
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:05<00:00,  4.19s/it]
464it [02:00,  3.87it/s]
Epoch 10: Dev loss 0.0364, F1 0.7173, RecEM 0.6416, SQLEM 0.0193, Err 12.02%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:47<00:00,  2.79it/s]
Epoch 11: Train loss 0.0475
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:05<00:00,  4.19s/it]
463it [02:00,  3.86it/s]
Epoch 11: Dev loss 0.0351, F1 0.7356, RecEM 0.6652, SQLEM 0.0193, Err 12.45%
Saving best model to checkpoints/ft_experiments/Ad_config_final/best_model.pt
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:48<00:00,  2.72it/s]
Epoch 12: Train loss 0.0452
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:06<00:00,  4.23s/it]
463it [02:00,  3.86it/s]
Epoch 12: Dev loss 0.0341, F1 0.7113, RecEM 0.6395, SQLEM 0.0193, Err 13.73%
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:47<00:00,  2.79it/s]
Epoch 13: Train loss 0.0445
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:07<00:00,  4.26s/it]
465it [02:00,  3.87it/s]
Epoch 13: Dev loss 0.0332, F1 0.7269, RecEM 0.6567, SQLEM 0.0193, Err 12.45%
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 133/133 [00:46<00:00,  2.87it/s]
Epoch 14: Train loss 0.0430
Evaluating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:06<00:00,  4.22s/it]
465it [02:00,  3.87it/s]
Epoch 14: Dev loss 0.0331, F1 0.7353, RecEM 0.6652, SQLEM 0.0193, Err 12.66%
Loading from checkpoints/ft_experiments/Ad_config_final/best_model.pt
Loading pretrained T5-small...
Model on cuda, 60.51M params
Test: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 27/27 [01:33<00:00,  3.45s/it]
Saving 432 test predictions...
428it [02:00,  3.57it/s] 

==================================================
Training and inference complete!
Files saved:
  - results/t5_ft_experiment_test.sql
  - records/t5_ft_experiment_test.pkl
==================================================
